***–ë–∞–π–µ—Å–æ–≤—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏***  
–ë–∞–π–µ—Å–æ–≤—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–µ –º–∞–∫—Å–∏–º—É–º–∞ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ : –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ![](http://latex.codecogs.com/svg.latex?%5Cinline%20p%28x%7Cy%29%20%3D%20p_y%28x%29)  ‚Äî **_—Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è_** –∫–ª–∞—Å—Å–æ–≤, –ø–æ –Ω–∏–º –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è ***–∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏*** - ![](http://latex.codecogs.com/svg.latex?P%20%5Cleft%20%5C%7By%7Cx%20%5Cright%20%5C%7D%20%3D%20P_yp_y%28x%29), –≥–¥–µ ![](http://latex.codecogs.com/svg.latex?%5Cinline%20P_y)- ***–∞–ø—Ä–∏–æ—Ä–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏*** –∫–ª–∞—Å—Å–æ–≤. –û–±—ä–µ–∫—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–ª–∞—Å—Å—É —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é.

*–ó–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏* - –ø–æ–ª—É—á–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º ![](http://latex.codecogs.com/svg.latex?%5Cinline%20a%3A%5C%3B%20X%5Cto%20Y), —Å–ø–æ—Å–æ–±–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç ![](http://latex.codecogs.com/svg.latex?%5Cinline%20x%20%5Cin%20X).  

1)  ***–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–ª–æ—Ç–Ω–æ—Å—Ç—è—Ö***  
![](http://latex.codecogs.com/svg.latex?%5Cinline%20%5Clambda_y) - —à—Ç—Ä–∞—Ñ –∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–Ω–µ—Å–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞—Å—Å–∞ ***ùë¶***.  
–ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã ![](http://latex.codecogs.com/svg.latex?%5Cinline%20P_y)  –∏ ![](http://latex.codecogs.com/svg.latex?%5Cinline%20p_%7By%7D%28x%29), —Ç–æ –º–∏–Ω–∏–º—É–º —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∏—Å–∫–∞ ![](http://latex.codecogs.com/svg.latex?%5Cinline%20R%28a%29%20%3D%20%5Csum_%7By%5Cepsilon%20Y%7D%20%5Csum_%7Bs%5Cepsilon%20Y%7D%20%5Clambda_yP_yP%28A_s%7Cy%29), ![](http://latex.codecogs.com/svg.latex?%5Cinline%20A_s%20%3D%20%5Cbigl%5C%7Bx%20%5Cin%20X%7Ca%28x%29%3Ds%5Cbigr%5C%7D%2C)  –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º ![](http://latex.codecogs.com/svg.latex?%5Cinline%20a%28x%29%20%3D%20%5Carg%5Cmax%20%5Clambda_yP_yp_y%28x%29)

2) ***–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –≤—ã–±–æ—Ä–∫–µ***  
–ü–æ –ø–æ–¥–≤—ã–±–æ—Ä–∫–µ  –∫–ª–∞—Å—Å–∞ *y* —Å—Ç—Ä–æ–∏–º —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ –æ—Ü–µ–Ω–∫–∏  ![](http://latex.codecogs.com/svg.latex?%5Cinline%20P_y) (–¥–æ–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤—ã–±–æ—Ä–∫–µ) –∏ ![](http://latex.codecogs.com/svg.latex?%5Cinline%20p_y%28x%29).  
–¢—Ä–∏ –º–µ—Ç–æ–¥–∞:  
**1)–ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π** –µ—Å–ª–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ (–≥–∞—É—Å—Å–æ–≤—Å–∫–∏–µ) - –ù–î–ê –∏ –õ–î–§;  
**2)–ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π** - –æ—Ü–µ–Ω–∫–∞ –ü–∞—Ä–∑–µ–Ω–∞ - –†–æ–∑–µ–Ω–±–ª–∞—Ç—Ç–∞, –º–µ—Ç–æ–¥ –ø–∞—Ä–∑–µ–Ω–æ–≤—Å–∫–æ–≥–æ –æ–∫–Ω–∞;   
**3)–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–º–µ—Å–∏** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è _–ï–ú-–∞–ª–≥–æ—Ä–∏—Ç–º–æ–º_. –ü–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–º–µ—Å–∏ (–≥–∞—É—Å—Å–æ–≤—Å–∫–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏) - —Ä–∞–¥–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏,–º–µ—Ç–æ–¥ —Ä–∞–¥–∏–∞–ª—å–Ω—ã—Ö –±–∞–∑–∏—Å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.

***–ù–∞–∏–≤–Ω—ã–π –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –±–∞–π–µ—Å–æ–≤—Å–∫–∏–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä***

–í—Å–µ –æ–±—ä–µ–∫—Ç—ã –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è _n_ —á–∏—Å–ª–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏, ![](http://latex.codecogs.com/svg.latex?x%20%3D%20%28%5Cxi_1%2C...%2C%5Cxi_n%29). –°–∞–º–∞ –Ω–∞–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–∏, —á—Ç–æ –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ ![](http://latex.codecogs.com/svg.latex?f_1%2C...%2Cf_n) - –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ –≤–µ–ª–∏—á–∏–Ω—ã, –∏ —Ç–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è –∫–ª–∞—Å—Å–æ–≤ (—Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏) : ![](http://latex.codecogs.com/svg.latex?p_y%28x%29%20%3D%20p_%7By1%7D%28%5Cxi_1%29...p_%7Byn%7D%28%5Cxi_n%29%2C%20y%20%5Cin%20Y), –≥–¥–µ ![](http://latex.codecogs.com/svg.latex?p_%7Byj%7D%28%5Cxi_j%29) - –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∑–Ω–∞—á–µ–Ω–∏–π _j_-–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –¥–ª—è –∫–ª–∞—Å—Å–∞ _y_.  

–û—Ü–µ–Ω–∫–∞ **n** –æ–¥–Ω–æ–º–µ—Ä–Ω—ã—Ö –ø–ª–æ—Ç–Ω–æ—Å—Ç–µ–π –ø—Ä–æ—â–µ, —á–µ–º –æ–¥–Ω–æ–π n-–º–µ—Ä–Ω–æ–π. –ü–æ–¥—Å—Ç–∞–≤–ª—è—è –æ—Ü–µ–Ω–∫–∏ ![](http://latex.codecogs.com/svg.latex?p_%7Byj%7D%28%5Cxi_j%29) –≤ _–û–ë–†–ü_, –ø–æ–ª—É—á–∏–º –±–∞–π–µ—Å–æ–≤—Å–∫–∏–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä:  

![](http://latex.codecogs.com/svg.latex?a%28x%29%20%3D%20%5Carg%5Cmax%5CBigr%28%5Cln%5Clambda_y%5Cwidehat%7BP%7D_y%20&plus;%20%5Csum_%7Bi%3D1%7D%5En%5Cln%5Cwidehat%7Bp%7D_%7Byj%7D%28%5Cxi_j%29%5CBigr%29)

–í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –∫–ª–∞—Å—Å—ã —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã ![](http://latex.codecogs.com/svg.latex?%5Clambda_y%5Cequiv%201), –±–∞–π–µ—Å–æ–≤—Å–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ - ***–ø—Ä–∏–Ω—Ü–∏–ø –º–∞–∫—Å–∏–º—É–º–∞ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏***. –ï—Å–ª–∏ –æ–Ω–∏ –µ—â—ë –∏ —Ä–∞–≤–Ω–æ–≤–µ—Ä–æ—è—Ç–Ω—ã ![](http://latex.codecogs.com/svg.latex?P_y%20%5Cequiv%20%5Cfrac%7B1%7D%7B%7CY%7C%7D) (—ç—Ç–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —É—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –∏—Ä–∏—Å–æ–≤ –§–∏—à–µ—Ä–∞), —Ç–æ –æ–±—ä–µ–∫—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–ª–∞—Å—Å—É —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ ![](http://latex.codecogs.com/svg.latex?p_y%28x%29) –≤ —Ç–æ—á–∫–µ.  

–í—Å—ë, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å - –ø–æ—Å—á–∏—Ç–∞—Ç—å –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ –∫–∞–∂–¥–æ–º –ø—Ä–∏–∑–Ω–∞–∫–µ —ç–ª–µ–º–µ–Ω—Ç–∞, –ø–µ—Ä–µ–º–Ω–æ–∂–∏—Ç—å –∏—Ö, –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∏ –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é. –ü–ª–æ—Ç–Ω–æ—Å—Ç—å —É –Ω–∞—Å –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è (–≥–∞—É—Å—Å–æ–≤—Å–∫–∞—è):
![](http://latex.codecogs.com/svg.latex?p_%7Byj%7D%28%5Cxi%29%20%3D%20%5Cfrac%7B1%7D%7B%5Csigma_%7Byj%7D%5Csqrt%7B2%5Cpi%7D%7D%5Cexp%5CBigr%28-%5Cfrac%7B%28%5Cxi-%5Cmu_%7Byj%7D%29%5E2%7D%7B2%5Csigma%5E2_%7Byj%7D%20%7D%5CBigr%29), –≥–¥–µ ![](http://latex.codecogs.com/svg.latex?%5Cmu_%7Byj%7D) - –º–∞—Ç–æ–∂–∏–¥–∞–Ω–∏–µ j-–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –∫–ª–∞—Å—Å–∞ y, ![](http://latex.codecogs.com/svg.latex?%5Csigma%5E2_%7Byj%7D) - –¥–∏—Å–ø–µ—Ä—Å–∏—è j-–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –∫–ª–∞—Å—Å–∞ y.

[–∏—Å—Ö–æ–¥–Ω–∏–∫](../NBA.R) 

<img src="pics/GNB.png" width="500">

**Pros** - –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–∏–∑–∫–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. **Cons** - –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

***–õ–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è***

[–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](https://zoncker.shinyapps.io/LLines/), –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º. (–°–ø–∞—Å–∏–±–æ Shiny –∑–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ö–æ—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π). [–∏—Å—Ö–æ–¥–Ω–∏–∫](../LLines/app.R)
```R
#—Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  x = matrix(c(x, y), 1, 2) 
  1 / sqrt((2 * pi) ^ 2 * det(covar)) * exp(-0.5 * (x - mean) %*% solve(covar) %*% t(x - mean))
```
```R
      #–≥—Ä–∞–Ω–∏—Ü—ã –∑–Ω–∞—á–µ–Ω–∏–π
      x = seq(-10, 10, len = 100)
      y = x
      z = outer(x, y, function(x, y) { #–ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ú–ù–† –∫ –¥–∞–Ω–Ω—ã–º —Å –ø–æ–º–æ—â—å—é sapply
        sapply(1:length(x), function(i) Bayes.MVND(x[i], y[i], mean, covar))
```

***NDA. Plug - in algorithm***

**–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑** - –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –±–∞–π–µ—Å–æ–≤—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏,–≥–¥–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ - –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –≥–∞—É—Å—Å–æ–≤—Å–∫–∏–µ: ![](http://latex.codecogs.com/gif.latex?%5Cinline%20N%28x%3B%5Cmu%20%2C%5Csum%29%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7B%282%5Cpi%29%5En%5Cleft%20%7C%20%5Csum%20%5Cright%20%7C%7D%7D%20%5Cexp%20%5Cleft%20%28%20%5Cfrac%7B-1%7D%7B2%7D%20%28x-%5Cmu%29%5ET%20%5Csum%5E%7B-1%7D%28x-%5Cmu%29%5Cright%20%29%2C%20x%20%5Cin%20%5Cmathbb%7BR%7D%5En), –≥–¥–µ ![](http://latex.codecogs.com/gif.latex?%5Cmu%20%5Cin%20%5Cmathbb%7BR%7D%5En) - –º–∞—Ç. –æ–∂–∏–¥–∞–Ω–∏–µ (—Ü–µ–Ω—Ç—Ä), –∞ ![](http://latex.codecogs.com/gif.latex?%5Csum%20%5Cin%20%5Cmathbb%7BR%7D%5E%7Bn%5Ctimes%20n%20%7D) - –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ - —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∏ –Ω–µ–≤—ã—Ä–æ–∂–¥–µ–Ω–Ω–∞—è.  

–ù–∞—Ö–æ–¥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ![](http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cmu_y%20%3D%20%5Cfrac%20%7B1%7D%7Bl_y%7D%20%5Csum_%7Bx_i%3Ay_i%20%3D%20y%7Dx_i)**(1)**, ![](http://latex.codecogs.com/gif.latex?%5Cinline%20%5Csum_y%20%3D%20%5Cfrac%7B1%7D%7Bl_y-1%7D%20%5Csum_%7Bx_i%3Ay_i%20%3D%20y%7D%28x_i%20-%20%5Cmu_y%29%28x_i-%5Cmu_y%29%5ET)**(2)**  –¥–ª—è ![](http://latex.codecogs.com/gif.latex?%5Cinline%20y%20%5Cin%20Y) —Å–æ–≥–ª–∞—Å–Ω–æ **–ø—Ä–∏–Ω—Ü–∏–ø—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è**, –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –≤ —Ñ–æ—Ä–º—É–ª—É ***–û–ë–†–ü*** –∏ –ø–æ–ª—É—á–∞–µ–º ***–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º***, –∏–ª–∏ ***–ª–∏–Ω–µ–π–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –§–∏—à–µ—Ä–∞*** (–µ—Å–ª–∏ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞–≤–Ω—ã –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤).

[–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é Shiny](https://zoncker.shinyapps.io/PlugIn/)


[–ò—Å—Ö–æ–¥–Ω–∏–∫](../PlugIn/app.R) 

–î–ª—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **MASS** –¥–∞–Ω–Ω—ã—Ö (–≤—ã–±–æ—Ä–∫–∞ —Å –¥–≤—É–º—è –∫–ª–∞—Å—Å–∞–º–∏) –≤—ã—á–∏—Å–ª—è–µ–º —Ü–µ–Ω—Ç—Ä—ã –ø–æ **(1)**:

```R
  cols <- dim(objects)[2]
  mu <- matrix(NA, 1, cols) #—Å–æ–∑–¥–∞—ë–º –≤–µ–∫—Ç–æ—Ä
  for (col in 1:cols)
  {
    mu[1, col] = mean(objects[,col]) #–ø–æ–¥—Å—á—ë—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
  }
```
–î–∞–ª–µ–µ, –Ω–∞—Ö–æ–¥–∏–º –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∫–ª–∞—Å—Å–æ–≤ –ø–æ **(2)** :
```R
  rows <- dim(objects)[1]
  cols <- dim(objects)[2]
  sigma <- matrix(0, cols, cols) #–Ω—É–ª–µ–≤–∞—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ 
  for (i in 1:rows)
  {
    sigma <- sigma + (t(objects[i,] - mu) %*% # - –æ–ø–µ—Ä–∞—Ç–æ—Ä —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü, t - transpose
                        (objects[i,] - mu)) / (rows - 1)
  }
```
–ò–∑ —Ç–µ–æ—Ä–µ–º—ã –∑–∞–¥–∞–Ω–∏—è –±–∞–π–µ—Å–æ–≤—Å–∫–∏–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∏–º –µ—ë —É—Ä–∞–≤–Ω–µ–Ω–∏–µ
![](https://latex.codecogs.com/gif.latex?%5Clambda_s%20P_sp_s%28x%29%20%3D%20%5Clambda_t%20P_tp_t%28x%29%2C)  
–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä—É—è, ![](https://latex.codecogs.com/gif.latex?%5Cln%20p_s%28x%29%20-%20%5Cln%20p_t%28x%29%20%3D%20C_%7Bst%7D),![](https://latex.codecogs.com/gif.latex?C_%7Bst%7D%20%3D%20%5Cln%28%5Clambda_tP_t/%5Clambda_sP_s%29) - –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç x.
–û—Å—Ç–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–∞ –∏–∑ –¥–≤—É—Ö –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º ln p(x) : ![](https://latex.codecogs.com/gif.latex?%5Cln%20p_y%28x%29%20%3D%20-%5Cfrac%7Bn%7D%7B2%7D%5Cln2%5Cpi%20-%20%5Cfrac%7B1%7D%7B2%7D%20%5Cln%20%7C%5Csum_y%7C-%5Cfrac%7B1%7D%7B2%7D%28x%20-%20%5Cmu_y%29%5ET%5Csum%5E%7B-1%7D_y%28x-%5Cmu_y%29)
```R
# –∫—Ä–∏–≤–∞—è –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞: a*x1^2 + b*x1*x2 + c*x2 + d*x1 + e*x2 + f = 0
  invSigma1 <- solve(sigma1)#–æ–±—Ä–∞—Ç–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã
  invSigma2 <- solve(sigma2)
  f <- log(abs(det(sigma1))) - log(abs(det(sigma2))) +
    mu1 %*% invSigma1 %*% t(mu1) - mu2 %*% invSigma2 %*%
    t(mu2);
  alpha <- invSigma1 - invSigma2
  a <- alpha[1, 1] #–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç - —ç–ª–µ–º–µ–Ω—Ç –º–∞—Ç—Ä–∏—Ü—ã
  b <- 2 * alpha[1, 2]#–ø–æ–ª—É—á–µ–Ω–Ω—ã–π –≤—ã—á–∏—Ç–∞–Ω–∏–µ–º –æ–±—Ä–∞—Ç–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü
  c <- alpha[2, 2]
  beta <- invSigma1 %*% t(mu1) - invSigma2 %*% t(mu2)
  d <- -2 * beta[1, 1]#–≤—Å—ë –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–∑ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π —Ñ–æ—Ä–º—ã
  e <- -2 * beta[2, 1]
  ##—Ä–µ—à–∞–µ–º –ø—Ä–æ–±–ª–µ–º—É –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ–¥–∞—á–µ–π –∏—Ö map-–æ–º
  return (c("x^2" = a, "xy" = b, "y^2" = c, "x" = d, "y" = e, "1" = f))
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**

<figure>
 <img src="pics/plug1.png" width="500">
 <img src="pics/plug2.png" width="500">
 <img src="pics/NDAEllips.png" width="500">
 <img src="pics/NDA2Lines.png" width="500">
  <figcaption>–ü—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ–∫–æ—Ä–µ–ª–ª–∏—Ä–æ–≤–∞–Ω—ã - –ª–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —ç–ª–ª–∏–ø—Å–æ–∏–¥–Ω—ã–µ, 
    —Å —Ü–µ–Ω—Ç—Ä–æ–º mu, –æ—Å–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã ox/oy.</figcaption>
</figure>

–ö–ª–∞—Å—Å—ã –Ω–µ —Ä–∞–≤–Ω–æ–≤–µ—Ä–æ—è—Ç–Ω—ã –∏–ª–∏ –Ω–µ —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã - —Ä–∞–∑–¥–µ–ª—è—é—â–∞—è –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å –æ—Ç–æ–¥–≤–∏–≥–∞–µ—Ç—Å—è –¥–∞–ª—å—à–µ –æ—Ç –±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º–æ–≥–æ –∫–ª–∞—Å—Å–∞.  

–ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –Ω–µ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã –∏ –Ω–µ —Ä–∞–≤–Ω—ã - —Ä–∞–∑–¥–µ–ª—è—é—â–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞ –∏ –ø—Ä–æ–≥–∏–±–∞–µ—Ç—Å—è - –º–µ–Ω–µ–µ –ø–ª–æ—Ç–Ω—ã–π –∫–ª–∞—Å—Å –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –±–æ–ª–µ–µ –ø–ª–æ—Ç–Ω—ã–π.

***–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏***

 - –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è –∫–ª–∞—Å—Å–æ–≤ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –≥–∞—É—Å—Å–æ–≤—Å–∫–∏—Ö: –∫–æ–≥–¥–∞ –∏–º–µ—é—Ç—Å—è –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–µ  –∑–Ω–∞—á–µ–Ω–∏—è, –∏–ª–∏
–∫–æ–≥–¥–∞ –∫–ª–∞—Å—Å—ã —Ä–∞—Å–ø–∞–¥–∞—é—Ç—Å—è –Ω–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏.
 - –ï—Å–ª–∏ –¥–ª–∏–Ω–∞ –≤—ã–±–æ—Ä–∫–∏ –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, **‚Ñìy < n**, –∏–ª–∏ —Å—Ä–µ–¥–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –µ—Å—Ç—å –ª–∏–Ω–µ–π–Ω–æ –∑–∞–≤–∏—Å–∏–º—ã–µ, —Ç–æ –∫–æ–≤–∞—Ä. –º–∞—Ç—Ä–∏—Ü–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—ã—Ä–æ–∂–¥–µ–Ω–Ω–æ–π. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –º–µ—Ç–æ–¥ –≤–æ–æ–±—â–µ –Ω–µ–ø—Ä–∏–º–µ–Ω–∏–º.
 - –í—ã–±–æ—Ä–æ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –∫ —Ä–µ–¥–∫–∏–º –±–æ–ª—å—à–∏–º –≤—ã–±—Ä–æ—Å–∞–º.

***–õ–∏–Ω–µ–π–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –§–∏—à–µ—Ä–∞***

***–ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã*** –∫–ª–∞—Å—Å–æ–≤ —Ä–∞–≤–Ω—ã, –∫–ª–∞—Å—Å—ã **s, t** —Ä–∞–≤–Ω–æ–≤–µ—Ä–æ—è—Ç–Ω—ã –∏ —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã ![](https://latex.codecogs.com/gif.latex?%5Clambda_sP_s%20%3D%20%5Clambda_tP_t), –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ ***–¥–∏—Å–ø–µ—Ä—Å–∏–∏*** ![](https://latex.codecogs.com/gif.latex?%5Csum_s%20%3D%20%5Csum_t%20%3D%20%5Csigma%20I_n).  

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–ª–∞—Å—Å—ã –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ñ–µ—Ä–∏—á–µ—Å–∫—É—é —Ñ–æ—Ä–º—É, —Ä–∞–∑–¥–µ–ª—è—é—â–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏, –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–æ –ª–∏–Ω–∏–∏, —Å–æ–µ–¥–∏–Ω—è—é—â–µ–π —Ü–µ–Ω—Ç—Ä—ã –∫–ª–∞—Å—Å–æ–≤. –ù–æ—Ä–º–∞–ª—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞ - –ø—Ä—è–º–∞—è, –≤ –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–π –ø—Ä–æ–µ–∫—Ü–∏–∏ –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –∫–ª–∞—Å—Å—ã —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è –Ω–∞–∏–ª—É—á—à–∏–º –æ–±—Ä–∞–∑–æ–º,—Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –±–∞–π–µ—Å–æ–≤—Å–∫–∏–º —Ä–∏—Å–∫–æ–º **R(a)**.

<img src="pics/FLDe.png" height = "200" width="500">

–ü—Ä–∏–º–µ–Ω—è—è ![](https://latex.codecogs.com/gif.latex?%5Cln%20p_y%28x%29%20%3D%20-%5Cfrac%7Bn%7D%7B2%7D%5Cln2%5Cpi%20-%20%5Cfrac%7B1%7D%7B2%7D%20%5Cln%20%7C%5Csum_y%7C-%5Cfrac%7B1%7D%7B2%7D%28x%20-%20%5Cmu_y%29%5ET%5Csum%5E%7B-1%7D_y%28x-%5Cmu_y%29) , –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ —á–ª–µ–Ω—ã —Å–æ–∫—Ä–∞—â–∞—é—Ç—Å—è –∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
–≤—ã—Ä–æ–∂–¥–∞–µ—Ç—Å—è –≤ –ª–∏–Ω–µ–π–Ω—É—é —Ñ–æ—Ä–º—É: ![](https://latex.codecogs.com/gif.latex?%28x-%5Cmu_%7Bst%7D%29%5ET%5Csum%5E%7B-1%7D%28%5Cmu_s-%5Cmu_t%29%20%3D%20C_%7Bst%7D), –≥–¥–µ ![](https://latex.codecogs.com/gif.latex?%5Cmu_%7Bst%7D%20%3D%20%5Cfrac%7B1%7D%7B2%7D%28%5Cmu_s&plus;%5Cmu_t%29) - —Ç–æ—á–∫–∞ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤.


[src](../FLD.R)

–ö–æ–¥ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**

<img src="pics/FLD1.png" width="500">

–ê–ª–≥–æ—Ä–∏—Ç–º –Ω–µ–ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ —Ñ–æ—Ä–º—ã –∫–ª–∞—Å—Å–æ–≤ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±–ª–∏–∑–∫–∏ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –∏ –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è.  

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ª–∏–Ω–µ–π–Ω–æ–µ —Ä–µ—à–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ –±–ª–∏–∑–∫–æ –∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º—É –±–∞–π–µ—Å–æ–≤—Å–∫–æ–º—É, –Ω–æ —É—Å—Ç–æ–π—á–∏–≤–µ–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ, –∏ —á–∞—Å—Ç–æ –æ–±–ª–∞–¥–∞–µ—Ç –ª—É—á—à–µ–π –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é.
